filter {
  if [type] == "tomcat" or [type] == "catalina" {
    grok {
      match => [
        "message", "%{TOMCATLOG}",
        "message", "%{CATALINALOG}"
      ]
    }
    date {
      match => [
        "timestamp",
        "yyyy-MM-dd HH:mm:ss,SSS Z",
        "MMM dd, yyyy HH:mm:ss a"
      ]
    }
  }
}
